(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{319:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"config-工具类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#config-工具类"}},[t._v("#")]),t._v(" config 工具类")]),t._v(" "),s("p",[t._v("bot 在启动之初会在 "),s("code",[t._v("config")]),t._v(" 目录下创建一系列配置文件。而该工具类所做的就是获取这些配置文件内容，并使开发者能够较为方便的实时获取它们。")]),t._v(" "),s("p",[t._v("工具类本质为一个对象，包含一个 "),s("code",[t._v("register()")]),t._v(" 方法与多个与配置文件名同名的属性。如 "),s("code",[t._v("config.base")]),t._v(" 对应 "),s("code",[t._v("base.yml")]),t._v("、"),s("code",[t._v("config.directive")]),t._v(" 对应 "),s("code",[t._v("directive.yml")]),t._v("。")]),t._v(" "),s("p",[t._v("具体 api 调用可以翻阅 "),s("RouterLink",{attrs:{to:"/api/global/config.html"}},[t._v("工具类 Config Api")])],1),t._v(" "),s("h2",{attrs:{id:"配置文件对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置文件对象"}},[t._v("#")]),t._v(" 配置文件对象")]),t._v(" "),s("p",[t._v("每与配置文件名同名的属性均为一个"),s("RouterLink",{attrs:{to:"/api/global/config.html#配置文件对象"}},[t._v("配置文件对象")]),t._v("。")],1),t._v(" "),s("h3",{attrs:{id:"配置文件内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置文件内容"}},[t._v("#")]),t._v(" 配置文件内容")]),t._v(" "),s("p",[t._v("以获取配置文件 "),s("code",[t._v("base.yml")]),t._v(" 中的 "),s("code",[t._v("master")]),t._v(" 号码为例，调用方式：")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" bot "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ROOT"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nbot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("base"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("master"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("其他配置文件的详细内容参考 "),s("RouterLink",{attrs:{to:"/config/base.html"}},[t._v("基本配置")])],1),t._v(" "),s("h3",{attrs:{id:"注册配置文件重载事件监听"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册配置文件重载事件监听"}},[t._v("#")]),t._v(" 注册配置文件重载事件监听")]),t._v(" "),s("p",[t._v("开发者可能期望当配置文件发生变化时执行一些自己的操作。例如某个属性值依赖于配置文件的 "),s("code",[t._v("master")]),t._v(" 属性，那么当 "),s("code",[t._v("master")]),t._v(" 发生变化时，理应同步更改这个属性值。")]),t._v(" "),s("p",[t._v("那么可以通过配置文件对象携带的 "),s("code",[t._v("on()")]),t._v(" 方法，来监听配置文件内容的变化。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 以 base.yml 举例")]),t._v("\nbot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("base"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"refresh"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" newCfg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCfg "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("该事件当且仅当"),s("strong",[t._v("文件内容发生变化")]),t._v("并"),s("strong",[t._v("执行了"),s("code",[t._v("#refresh")]),t._v("指令")]),t._v("时触发，并默认情况下向发送指令方发送提示 "),s("code",[t._v("xxx.yml 重新加载完毕")]),t._v("。")]),t._v(" "),s("p",[t._v("其中回调函数参数 "),s("code",[t._v("newCfg")]),t._v(" 与 "),s("code",[t._v("oldCfg")]),t._v(" 分别表示刷新前后的配置项值。")]),t._v(" "),s("p",[t._v("当回调函数返回 "),s("code",[t._v("string")]),t._v(" 类型的值时，将替代默认的刷新成功的打印文本（如果你不希望发送任何提示消息，则返回 "),s("code",[t._v('""')]),t._v("）。")]),t._v(" "),s("p",[t._v("下面是一个示例，用于监控 "),s("code",[t._v("base.yml")]),t._v(" 中的 "),s("code",[t._v("master")]),t._v(" 内容变更，并同步到自定义的参数 "),s("code",[t._v("botMaster")]),t._v("。且当 "),s("code",[t._v("master")]),t._v(" 内容变更时，发送响应消息 "),s("code",[t._v("bot 主人账号重载成功")]),t._v("，反之不发送任何内容。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" bot "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ROOT"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" botMaster "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("master"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("base"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"refresh"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" newCfg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCfg "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" newCfg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("master "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" oldCfg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("master "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        botMaster "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCfg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("master"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bot 主人账号重载成功"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"清除配置文件重载事件监听事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#清除配置文件重载事件监听事件"}},[t._v("#")]),t._v(" 清除配置文件重载事件监听事件")]),t._v(" "),s("p",[t._v("可以通过配置文件对象携带的 "),s("code",[t._v("clear()")]),t._v(" 方法，来清除配置文件重载事件监听事件。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" bot "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ROOT"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nbot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("base"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("clear")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"refresh"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("注意：这将会清除掉 bot 对应配置文件对象的重载事件，对应配置文件将无法正常响应 "),s("code",[t._v("#refresh")]),t._v(" 重载指令。若非你有特殊要求（例如重写框架的重载逻辑），否则我们不建议开发者操作该方法。")])]),t._v(" "),s("h2",{attrs:{id:"注册插件配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册插件配置文件"}},[t._v("#")]),t._v(" 注册插件配置文件")]),t._v(" "),s("p",[t._v("可通过 "),s("code",[t._v("register()")]),t._v(" 方法来为插件注册并创建一个配置文件，具体请查看 "),s("RouterLink",{attrs:{to:"/guide/plugin/config-file.html#注册插件配置文件"}},[t._v("注册插件配置文件")]),t._v("。")],1)])}),[],!1,null,null,null);s.default=e.exports}}]);