(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{328:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"生命周期钩子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生命周期钩子"}},[t._v("#")]),t._v(" 生命周期钩子")]),t._v(" "),s("p",[t._v("插件存在两个生命周期钩子："),s("code",[t._v("mounted")]),t._v(" 与 "),s("code",[t._v("unmounted")]),t._v("，均可以在插件配置对象中定义，支持同步或异步方法。他们使插件开发者可以在特定阶段运行自己的代码。")]),t._v(" "),s("h2",{attrs:{id:"全部钩子函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全部钩子函数"}},[t._v("#")]),t._v(" 全部钩子函数")]),t._v(" "),s("h3",{attrs:{id:"mounted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mounted"}},[t._v("#")]),t._v(" mounted")]),t._v(" "),s("p",[t._v("bot 在启动后，将会依次加载所检测到的所有插件。待所有插件入口配置读取完毕后，将会依次执行每个插件的 "),s("code",[t._v("mounted")]),t._v(" 钩子函数。")]),t._v(" "),s("p",[t._v("在插件重载时也会执行此钩子函数。")]),t._v(" "),s("blockquote",[s("p",[t._v("我们强烈推荐你在 "),s("code",[t._v("mounted")]),t._v(" 生命周期钩子函数中进行原来的插件的初始化行为。这样可以有效的避免一些加载顺序导致的变量未定义情况，例如其他文件在通过 "),s("code",[t._v('import bot from "ROOT"')]),t._v(" 使用框架库时提示 "),s("code",[t._v("bot 未定义")]),t._v("。")])]),t._v(" "),s("h3",{attrs:{id:"unmounted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unmounted"}},[t._v("#")]),t._v(" unmounted")]),t._v(" "),s("p",[t._v("当插件重载时，会先执行此钩子函数。")]),t._v(" "),s("blockquote",[s("p",[t._v("由于重载会重新执行插件入口代码，请务必在此钩子函数中释放会多次重复加载的开销代码，或是监听的端口。")])]),t._v(" "),s("h2",{attrs:{id:"钩子函数参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#钩子函数参数"}},[t._v("#")]),t._v(" 钩子函数参数")]),t._v(" "),s("p",[t._v("每一个钩子函数均接受类型为 "),s("code",[t._v("PluginParameter")]),t._v(" 的形参，包含 "),s("code",[t._v("BOT")]),t._v(" 核心类与额外的配置项注册方法 "),s("code",[t._v("configRegister")]),t._v("、渲染器注册方法 "),s("code",[t._v("renderRegister")]),t._v(" 与别名设置方法 "),s("code",[t._v("setAlias")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"setalias"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setalias"}},[t._v("#")]),t._v(" setAlias")]),t._v(" "),s("p",[t._v("用于设置插件的别名，插件的别名可用于 更新插件、重载插件 等命令。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("definePlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" params "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAlias")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"茉莉"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"refreshregister"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#refreshregister"}},[t._v("#")]),t._v(" refreshRegister")]),t._v(" "),s("p",[t._v("其使用方式与原来的 "),s("code",[t._v("bot.refresh.register")]),t._v(" 方法完全相同，为了替代后者而诞生。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("definePlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" params "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("refreshRegister")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 刷新方法")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"renderregister"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#renderregister"}},[t._v("#")]),t._v(" renderRegister")]),t._v(" "),s("p",[s("code",[t._v("PluginSetting.renderer.register")]),t._v(" 的插件便捷使用方式。")]),t._v(" "),s("p",[t._v("免去了提供第一个参数 "),s("code",[t._v("route")]),t._v("，自动以 "),s("code",[t._v("/插件名（插件目录名）")]),t._v(" 作为基地址来注册渲染器。")])])}),[],!1,null,null,null);s.default=e.exports}}]);